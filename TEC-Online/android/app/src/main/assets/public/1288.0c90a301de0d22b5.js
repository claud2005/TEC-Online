"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1288],{1288:(G,m,l)=>{l.r(m),l.d(m,{ResetPasswordPage:()=>E});var f=l(467),g=l(4341),a=l(4742),h=l(177),M=l(9350),P=l(5312),n=l(4438),_=l(6960),w=l(1626);function v(r,c){1&r&&(n.j41(0,"div",11),n.nrm(1,"ion-icon",12),n.j41(2,"p"),n.EFF(3,"Token inv\xe1lido ou expirado. Solicite um novo link de redefini\xe7\xe3o."),n.k0s(),n.j41(4,"ion-button",13),n.EFF(5," Solicitar novo link "),n.k0s()())}function x(r,c){1&r&&(n.j41(0,"span"),n.EFF(1,"Campo obrigat\xf3rio"),n.k0s())}function b(r,c){1&r&&(n.j41(0,"span"),n.EFF(1,"M\xednimo 8 caracteres"),n.k0s())}function k(r,c){if(1&r&&(n.j41(0,"div",26),n.DNE(1,x,2,0,"span",10)(2,b,2,0,"span",10),n.k0s()),2&r){let i,e;const t=n.XpG(2);n.R7$(),n.Y8G("ngIf",null==(i=t.resetForm.get("password"))?null:i.hasError("required")),n.R7$(),n.Y8G("ngIf",null==(e=t.resetForm.get("password"))?null:e.hasError("minlength"))}}function F(r,c){1&r&&(n.j41(0,"div",26),n.EFF(1," As senhas n\xe3o coincidem "),n.k0s())}function R(r,c){if(1&r&&(n.j41(0,"div",27),n.nrm(1,"div",28),n.j41(2,"span"),n.EFF(3),n.k0s()()),2&r){const i=n.XpG(2);n.R7$(),n.HbH(i.getPasswordStrengthClass()),n.R7$(2),n.JRh(i.getPasswordStrengthText())}}function y(r,c){if(1&r){const i=n.RV6();n.j41(0,"div")(1,"h2"),n.EFF(2,"Crie sua nova senha"),n.k0s(),n.j41(3,"p",14),n.EFF(4,"Digite e confirme sua nova senha abaixo"),n.k0s(),n.j41(5,"form",15),n.bIt("ngSubmit",function(){n.eBV(i);const t=n.XpG();return n.Njj(t.onSubmit())}),n.j41(6,"div",16)(7,"label"),n.EFF(8,"Nova Senha"),n.k0s(),n.j41(9,"div",17),n.nrm(10,"ion-input",18),n.j41(11,"ion-icon",19),n.bIt("click",function(){n.eBV(i);const t=n.XpG();return n.Njj(t.togglePasswordVisibility())}),n.k0s(),n.nrm(12,"ion-icon",20),n.k0s(),n.DNE(13,k,3,2,"div",21),n.k0s(),n.j41(14,"div",16)(15,"label"),n.EFF(16,"Confirmar Senha"),n.k0s(),n.j41(17,"div",17),n.nrm(18,"ion-input",22),n.j41(19,"ion-icon",19),n.bIt("click",function(){n.eBV(i);const t=n.XpG();return n.Njj(t.toggleConfirmPasswordVisibility())}),n.k0s(),n.nrm(20,"ion-icon",20),n.k0s(),n.DNE(21,F,2,0,"div",21),n.k0s(),n.DNE(22,R,4,3,"div",23),n.j41(23,"ion-button",24),n.nrm(24,"ion-icon",25),n.EFF(25," Redefinir Senha "),n.k0s()()()}if(2&r){let i,e,t,s;const o=n.XpG();n.Y8G("@fadeIn",void 0),n.R7$(5),n.Y8G("formGroup",o.resetForm),n.R7$(),n.AVh("invalid",(null==(i=o.resetForm.get("password"))?null:i.invalid)&&(null==(i=o.resetForm.get("password"))?null:i.touched)),n.R7$(4),n.Y8G("type",o.showPassword?"text":"password"),n.R7$(),n.Y8G("name",o.showPassword?"eye-off-outline":"eye-outline"),n.R7$(2),n.Y8G("ngIf",null==(e=o.resetForm.get("password"))?null:e.touched),n.R7$(),n.AVh("invalid",o.passwordsDoNotMatch||(null==(t=o.resetForm.get("confirmPassword"))?null:t.invalid)&&(null==(t=o.resetForm.get("confirmPassword"))?null:t.touched)),n.R7$(4),n.Y8G("type",o.showConfirmPassword?"text":"password"),n.R7$(),n.Y8G("name",o.showConfirmPassword?"eye-off-outline":"eye-outline"),n.R7$(2),n.Y8G("ngIf",o.passwordsDoNotMatch),n.R7$(),n.Y8G("ngIf",null==(s=o.resetForm.get("password"))?null:s.value),n.R7$(),n.Y8G("disabled",!o.resetForm.valid||o.passwordsDoNotMatch)}}let E=(()=>{var r;class c{constructor(e,t,s,o,d){this.route=e,this.fb=t,this.http=s,this.router=o,this.alertController=d,this.token="",this.isTokenValid=!1,this.passwordsDoNotMatch=!1,this.passwordMatchValidator=C=>{var u,p;return(null===(u=C.get("password"))||void 0===u?void 0:u.value)===(null===(p=C.get("confirmPassword"))||void 0===p?void 0:p.value)?null:{mismatch:!0}},this.showPassword=!1,this.showConfirmPassword=!1}ngOnInit(){var e=this;this.token=this.route.snapshot.paramMap.get("token")||"",this.token?this.http.get(`${P.c.api_url}/api/verify-token/${this.token}`).subscribe(()=>{this.isTokenValid=!0},function(){var t=(0,f.A)(function*(s){console.error("Erro ao validar o token:",s),e.isTokenValid=!1,yield(yield e.alertController.create({header:"Erro",message:"O token de redefini\xe7\xe3o de senha \xe9 inv\xe1lido ou expirou. Tente novamente.",buttons:["OK"]})).present()});return function(s){return t.apply(this,arguments)}}()):this.isTokenValid=!1,this.resetForm=this.fb.group({password:["",[g.k0.required,g.k0.minLength(6)]],confirmPassword:["",[g.k0.required]]},{validators:this.passwordMatchValidator}),this.resetForm.valueChanges.subscribe(()=>{var t,s;this.passwordsDoNotMatch=(null===(t=this.resetForm.get("password"))||void 0===t?void 0:t.value)!==(null===(s=this.resetForm.get("confirmPassword"))||void 0===s?void 0:s.value)})}getPasswordStrengthClass(){var e;const t=null===(e=this.resetForm.get("password"))||void 0===e?void 0:e.value;if(!t||0===t.length)return"";const s=this.calculatePasswordStrength(t);return s<40?"weak":s<70?"medium":"strong"}getPasswordStrengthText(){var e;const t=null===(e=this.resetForm.get("password"))||void 0===e?void 0:e.value;if(!t||0===t.length)return"";const s=this.calculatePasswordStrength(t);return s<40?"\u{1f534} Fraca":s<70?"\u{1f7e1} M\xe9dia":"\u{1f7e2} Forte"}calculatePasswordStrength(e){let t=0;return t+=Math.min(5*e.length,40),/[A-Z]/.test(e)&&(t+=15),/[0-9]/.test(e)&&(t+=15),/[^A-Za-z0-9]/.test(e)&&(t+=20),e.length>10&&(t+=10),Math.min(t,100)}onSubmit(){var e=this;return(0,f.A)(function*(){if(e.resetForm.invalid)return;const t=e.resetForm.value.password;try{const o=yield function O(r,c){const i="object"==typeof c;return new Promise((e,t)=>{let o,s=!1;r.subscribe({next:d=>{o=d,s=!0},error:t,complete:()=>{s?e(o):i?e(c.defaultValue):t(new M.G)}})})}(e.http.post(`${P.c.api_url}/api/reset-password`,{token:e.token,novaSenha:t}));yield(yield e.alertController.create({header:o.success?"Sucesso":"Erro",message:o.message,buttons:[{text:"OK",handler:()=>{o.success&&e.router.navigate(["/login"])}}]})).present()}catch(o){var s;console.error("Erro ao alterar senha:",o),yield(yield e.alertController.create({header:"Erro",message:(null===(s=o.error)||void 0===s?void 0:s.message)||"Erro desconhecido",buttons:["OK"]})).present()}})()}togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}}return(r=c).\u0275fac=function(e){return new(e||r)(n.rXU(_.nX),n.rXU(g.ok),n.rXU(w.Qq),n.rXU(_.Ix),n.rXU(a.hG))},r.\u0275cmp=n.VBU({type:r,selectors:[["app-reset-password"]],decls:13,vars:6,consts:[[3,"translucent"],["color","primary"],["slot","start"],["defaultHref","/home"],[3,"fullscreen"],[1,"auth-container"],[1,"illustration"],["name","lock-closed","size","large"],[1,"form-container"],["class","error-card",4,"ngIf"],[4,"ngIf"],[1,"error-card"],["name","warning-outline"],["expand","block","fill","clear","routerLink","/forgot-password"],[1,"subtext"],[3,"ngSubmit","formGroup"],[1,"input-group"],[1,"input-wrapper"],["formControlName","password","placeholder","M\xednimo 8 caracteres","autocomplete","new-password",3,"type"],[1,"toggle-icon",3,"click","name"],["name","lock-closed-outline"],["class","hint",4,"ngIf"],["formControlName","confirmPassword","placeholder","Digite novamente","autocomplete","new-password",3,"type"],["class","password-strength",4,"ngIf"],["expand","block","type","submit",1,"submit-btn",3,"disabled"],["name","checkmark-circle-outline","slot","start"],[1,"hint"],[1,"password-strength"],[1,"strength-bar"]],template:function(e,t){1&e&&(n.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),n.nrm(3,"ion-back-button",3),n.k0s(),n.j41(4,"ion-title"),n.EFF(5,"Redefinir Senha"),n.k0s()()(),n.j41(6,"ion-content",4)(7,"div",5)(8,"div",6),n.nrm(9,"ion-icon",7),n.k0s(),n.j41(10,"div",8),n.DNE(11,v,6,0,"div",9)(12,y,26,14,"div",10),n.k0s()()()),2&e&&(n.Y8G("translucent",!0),n.R7$(6),n.Y8G("fullscreen",!0),n.R7$(4),n.AVh("invalid-token",!t.isTokenValid),n.R7$(),n.Y8G("ngIf",!t.isTokenValid),n.R7$(),n.Y8G("ngIf",t.isTokenValid))},dependencies:[a.bv,a.Jm,a.QW,a.W9,a.eU,a.iq,a.$w,a.BC,a.ai,a.Gw,a.el,a.N7,h.MD,h.bT,g.X1,g.qT,g.BC,g.cb,g.j4,g.JD],styles:["ion-content[_ngcontent-%COMP%]{--background: #e0e7ef}.auth-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:24px;height:100%;justify-content:center}.auth-container[_ngcontent-%COMP%]   .illustration[_ngcontent-%COMP%]{margin-bottom:24px}.auth-container[_ngcontent-%COMP%]   .illustration[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px;color:var(--ion-color-primary)}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{width:100%;max-width:400px;background:#fff;border-radius:16px;padding:24px;box-shadow:0 4px 20px #00000014;transition:all .3s ease}.auth-container[_ngcontent-%COMP%]   .form-container.invalid-token[_ngcontent-%COMP%]{border:1px solid var(--ion-color-danger)}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px;margin-bottom:8px;color:#222;text-align:center}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subtext[_ngcontent-%COMP%]{font-size:14px;color:#666;text-align:center;margin-bottom:24px}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]{background:#ffe5e5;border:1px solid var(--ion-color-danger);padding:16px;border-radius:12px;text-align:center;color:var(--ion-color-danger);margin-bottom:16px}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 12px}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{margin-bottom:20px}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;display:block;margin-bottom:6px;font-size:14px;color:#333}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;background:#f1f3f5;border-radius:8px;padding:8px 12px}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{flex:1;--padding-start: 0;--background: transparent;--color: #222;font-size:16px;border:none}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#666;font-size:20px}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group.invalid[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{border:1px solid var(--ion-color-danger)}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-group.invalid[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{color:var(--ion-color-danger);font-size:13px;margin-top:4px}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .password-strength[_ngcontent-%COMP%]{margin-bottom:16px;text-align:center}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .password-strength[_ngcontent-%COMP%]   .strength-bar[_ngcontent-%COMP%]{height:6px;border-radius:3px;margin-bottom:8px;transition:width .3s ease,background-color .3s ease}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .password-strength[_ngcontent-%COMP%]   .weak[_ngcontent-%COMP%]{background:#e74c3c;width:33%}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .password-strength[_ngcontent-%COMP%]   .medium[_ngcontent-%COMP%]{background:#f39c12;width:66%}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .password-strength[_ngcontent-%COMP%]   .strong[_ngcontent-%COMP%]{background:#2ecc71;width:100%}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .password-strength[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#444}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]{margin-top:12px;font-weight:700;font-size:16px;--border-radius: 10px}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;background:#f1f3f5;border-radius:8px;padding:8px 12px}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{flex:1;--padding-start: 0;--background: transparent;--color: #222;font-size:16px;border:none}.auth-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{color:#666;font-size:20px;margin-left:10px;cursor:pointer}"]}),c})()}}]);