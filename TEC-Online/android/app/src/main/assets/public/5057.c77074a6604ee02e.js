"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5057],{5057:(P,g,a)=>{a.r(g),a.d(g,{AdicionarClientePageModule:()=>F});var p=a(177),e=a(4341),i=a(4742),C=a(6960),u=a(467),o=a(4438),h=a(3656);const b=[{path:"",component:(()=>{var t;class c{constructor(n,r,l){this.navCtrl=n,this.formBuilder=r,this.toastController=l,this.ultimoCodigoCliente=0,this.clienteForm=this.formBuilder.group({nome:["",[e.k0.required,e.k0.minLength(3)]],morada:["",[e.k0.required]],codigoPostal:["",[e.k0.required,e.k0.pattern("^[0-9]{4}-[0-9]{3}$")]],contacto:["",[e.k0.required,e.k0.pattern("^[0-9]{9}$")]],email:["",[e.k0.required,e.k0.email]],contribuinte:["",[e.k0.required,e.k0.pattern("^[0-9]{9}$")]],codigoCliente:[""],numeroCliente:[""]}),this.carregarUltimoCodigo()}carregarUltimoCodigo(){var n=this;return(0,u.A)(function*(){const r=localStorage.getItem("ultimoCodigoCliente");n.ultimoCodigoCliente=r?parseInt(r,10):0})()}salvarCliente(){var n=this;return(0,u.A)(function*(){const r=localStorage.getItem("token");if(!r)return void(yield n.mostrarToast("Usu\xe1rio n\xe3o autenticado. Fa\xe7a login novamente.","danger"));if(n.clienteForm.invalid)return n.marcarCamposInvalidos(),void(yield n.mostrarToast("Por favor, preencha todos os campos corretamente.","warning"));const l=n.ultimoCodigoCliente+1,f=l.toString().padStart(2,"0"),v={...n.clienteForm.value,codigoCliente:f,numeroCliente:l};try{const s=yield fetch("https://tec-online-api.vercel.app/api/clientes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(v)}),m=yield s.json();if(!s.ok)throw m;n.ultimoCodigoCliente=l,localStorage.setItem("ultimoCodigoCliente",String(n.ultimoCodigoCliente)),yield n.mostrarToast("Cliente salvo com sucesso!","success"),n.clienteForm.reset()}catch(s){console.error("Erro ao salvar cliente:",s);let m="Erro ao salvar cliente";null!=s&&s.message&&(m+=`: ${s.message}`),yield n.mostrarToast(m,"danger")}})()}marcarCamposInvalidos(){Object.values(this.clienteForm.controls).forEach(n=>{n.invalid&&(n.markAsTouched(),n.updateValueAndValidity())})}mostrarToast(n,r="primary"){var l=this;return(0,u.A)(function*(){yield(yield l.toastController.create({message:n,duration:3e3,color:r,position:"top"})).present()})()}voltar(){this.navCtrl.back()}}return(t=c).\u0275fac=function(n){return new(n||t)(o.rXU(h.q9),o.rXU(e.ok),o.rXU(i.K_))},t.\u0275cmp=o.VBU({type:t,selectors:[["app-adicionar-cliente"]],decls:69,vars:1,consts:[[1,"ion-padding","conteudo-branco"],[1,"form-card"],[2,"margin-bottom","12px"],[2,"font-size","1.75rem","font-weight","700","color","#1a3d7c"],[1,"info-card"],["name","information-circle-outline","slot","start"],[3,"ngSubmit","formGroup"],["name","person-outline","slot","start"],["size","6"],["position","floating"],["formControlName","nome","required",""],["formControlName","codigoPostal","required",""],["formControlName","morada","type","text","required",""],["formControlName","email","type","email","required",""],["formControlName","contacto","type","tel","maxlength","9","required",""],["formControlName","contribuinte","type","tel","maxlength","9","required",""],["formControlName","codigoCliente","readonly",""],[1,"ion-margin-top"],["expand","block","color","medium",3,"click"],["name","arrow-back-outline","slot","start"],["expand","block","type","submit","color","success"],["name","save-outline","slot","start"]],template:function(n,r){1&n&&(o.j41(0,"ion-content",0)(1,"ion-card",1)(2,"div",2)(3,"h1",3),o.EFF(4,"Adicionar Cliente"),o.k0s()(),o.j41(5,"ion-card",4)(6,"ion-card-header")(7,"ion-card-title"),o.nrm(8,"ion-icon",5),o.EFF(9," Informa\xe7\xf5es B\xe1sicas "),o.k0s()(),o.j41(10,"ion-card-content"),o.EFF(11," Preencha os dados abaixo para cadastrar um novo cliente no sistema. Os campos marcados como obrigat\xf3rios devem ser preenchidos para continuar. "),o.k0s()(),o.j41(12,"form",6),o.bIt("ngSubmit",function(){return r.salvarCliente()}),o.j41(13,"ion-card",1)(14,"ion-card-header")(15,"ion-card-title"),o.nrm(16,"ion-icon",7),o.EFF(17," Identifica\xe7\xe3o "),o.k0s()(),o.j41(18,"ion-card-content")(19,"ion-grid")(20,"ion-row")(21,"ion-col",8)(22,"ion-item")(23,"ion-label",9),o.EFF(24,"Nome"),o.k0s(),o.nrm(25,"ion-input",10),o.k0s()(),o.j41(26,"ion-col",8)(27,"ion-item")(28,"ion-label",9),o.EFF(29,"C\xf3digo Postal"),o.k0s(),o.nrm(30,"ion-input",11),o.k0s()()(),o.j41(31,"ion-row")(32,"ion-col",8)(33,"ion-item")(34,"ion-label",9),o.EFF(35,"Morada"),o.k0s(),o.nrm(36,"ion-input",12),o.k0s()(),o.j41(37,"ion-col",8)(38,"ion-item")(39,"ion-label",9),o.EFF(40,"Email"),o.k0s(),o.nrm(41,"ion-input",13),o.k0s()()(),o.j41(42,"ion-row")(43,"ion-col",8)(44,"ion-item")(45,"ion-label",9),o.EFF(46,"Contacto"),o.k0s(),o.nrm(47,"ion-input",14),o.k0s()(),o.j41(48,"ion-col",8)(49,"ion-item")(50,"ion-label",9),o.EFF(51,"Contribuinte"),o.k0s(),o.nrm(52,"ion-input",15),o.k0s()()(),o.j41(53,"ion-row")(54,"ion-col",8)(55,"ion-item")(56,"ion-label",9),o.EFF(57,"C\xf3digo Cliente"),o.k0s(),o.nrm(58,"ion-input",16),o.k0s()()()()()(),o.j41(59,"ion-grid",17)(60,"ion-row")(61,"ion-col")(62,"ion-button",18),o.bIt("click",function(){return r.voltar()}),o.nrm(63,"ion-icon",19),o.EFF(64," Voltar "),o.k0s()(),o.j41(65,"ion-col")(66,"ion-button",20),o.nrm(67,"ion-icon",21),o.EFF(68," Salvar "),o.k0s()()()()()()()),2&n&&(o.R7$(12),o.Y8G("formGroup",r.clienteForm))},dependencies:[i.bv,i.Jm,i.b_,i.I9,i.ME,i.tN,i.hU,i.W9,i.lO,i.iq,i.$w,i.uz,i.he,i.ln,i.Gw,e.YN,e.qT,e.BC,e.cb,e.YS,e.tU,e.X1,e.j4,e.JD,p.MD],styles:['@charset "UTF-8";.conteudo-branco[_ngcontent-%COMP%]{background-color:#fff;font-family:Arial,sans-serif;color:#000}.form-card[_ngcontent-%COMP%]{margin-bottom:16px;padding:12px;background-color:#fff;border:1px solid #ddd;border-radius:4px}.info-card[_ngcontent-%COMP%]{background-color:#f1f1f1;border-left:4px solid #aaa;padding:12px;margin-bottom:16px;color:#000}ion-card-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#000;display:flex;align-items:center;gap:6px;padding:8px 0}ion-item[_ngcontent-%COMP%]{--background: transparent;border-bottom:1px solid #ccc;padding-left:0;padding-right:0;--padding-start: 0;--inner-padding-end: 0;--inner-padding-start: 0;--highlight-color-focused: #666;color:#000}ion-input[readonly][_ngcontent-%COMP%]{background-color:#f5f5f5;color:#000}.endereco-textarea[_ngcontent-%COMP%], .observacoes-textarea[_ngcontent-%COMP%]{min-height:60px;font-size:.95rem;color:#000}ion-label[_ngcontent-%COMP%]{color:#000;font-weight:400}ion-button[_ngcontent-%COMP%]{font-weight:400;--border-radius: 4px;box-shadow:none;color:#000}ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:4px}@media screen and (max-width: 768px){ion-col[size="6"][_ngcontent-%COMP%]{flex:0 0 100%;max-width:100%}}ion-item.morada-item[_ngcontent-%COMP%]{padding-top:-20px;border-bottom:1px solid #ccc}']}),c})()}];let k=(()=>{var t;class c{}return(t=c).\u0275fac=function(n){return new(n||t)},t.\u0275mod=o.$C({type:t}),t.\u0275inj=o.G2t({imports:[C.iI.forChild(b),C.iI]}),c})(),F=(()=>{var t;class c{}return(t=c).\u0275fac=function(n){return new(n||t)},t.\u0275mod=o.$C({type:t}),t.\u0275inj=o.G2t({imports:[p.MD,e.YN,i.bv,k]}),c})()}}]);